<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard — MindWell AI</title>
    <!-- Favicon -->
    <link rel="icon" href="images/favicon.svg" type="image/svg+xml" />
    <!-- Google Fonts: Inter & Nunito Sans -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Nunito+Sans:wght@700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome for extra icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css" />
    <style>
      /* Journal list styles */
      #journalList li {
        background-color: #f8f9fa;
        border-left: 4px solid #0d6efd;
        transition: all 0.2s ease;
        flex-direction: column;
        align-items: center;
        text-align: center;
      }
      #journalList li:hover {
        background-color: #e9f2ff;
      }
    </style>
  </head>
  <body>
    <!-- NAVBAR: sticky header, logo, improved accessibility -->
    <header>
      <nav
        class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top"
        role="navigation"
        aria-label="Main Navigation"
      >
        <div class="container">
          <a class="navbar-brand d-flex align-items-center" href="index.html">
            <img
              src="images/favicon.svg"
              alt="MindWell AI Logo"
              class="logo-image"
              width="32"
              height="32"
            />
            <span class="brand-text">MindWell AI</span>
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#mainNav"
            aria-controls="mainNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <i class="fa-solid fa-bars" aria-hidden="true"></i>
          </button>
          <div class="collapse navbar-collapse" id="mainNav">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link" href="features.html"
                  ><i class="fa-solid fa-bolt"></i> Features</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="resources.html"
                  ><i class="fa-solid fa-book"></i> Resources</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="about.html"
                  ><i class="fa-solid fa-circle-info"></i> About</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="contact.html"
                  ><i class="fa-solid fa-envelope"></i> Contact</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="dashboard.html"
                  ><i class="fa-solid fa-user-circle"></i> Profile</a
                >
              </li>
              <li class="nav-item">
                <button class="btn btn-outline-danger ms-2" onclick="logout()">
                  Logout
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <div class="container mt-5">
      <h2 id="welcome" class="text-primary mb-4"></h2>

      <!-- Profile Section -->
      <div class="mb-4">
        <h5>Profile Info</h5>
        <form id="profileForm" class="mb-3">
          <div class="mb-2">
            <label for="name" class="form-label">Name</label>
            <input type="text" id="name" class="form-control" />
          </div>
          <div class="mb-2">
            <label for="email" class="form-label">Email</label>
            <input type="email" id="email" class="form-control" />
          </div>
          <button type="submit" class="btn btn-success mt-2">
            Update Profile
          </button>
        </form>
        <div id="profileMsg" class="text-success"></div>
      </div>

      <!-- Mood Tracker Section -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="card-title text-primary">Daily Mood Tracker</h5>
          <p class="text-muted mb-3">
            Answer these questions to reflect on your day. Your responses help
            us suggest ways to improve your wellbeing.
          </p>

          <form id="moodForm" class="mb-3">
            <div id="moodQuestions">
              <!-- Questions dynamically loaded here -->
            </div>
            <button type="submit" class="btn btn-primary mt-3">
              Submit Check-In
            </button>
          </form>

          <div id="moodFeedback" class="mt-3 fw-bold"></div>

          <canvas id="moodChart" class="mt-4"></canvas>
        </div>
      </div>

      <!-- Tasks Section -->
      <div class="row mt-4">
        <div class="col-md-6">
          <h5>Tasks Completed</h5>
          <ul id="tasksDone" class="list-group mb-3"></ul>
        </div>

        <div class="col-md-6">
          <h5>Tasks To Do</h5>
          <ul id="tasksToDo" class="list-group mb-3"></ul>

          <form id="addTaskForm" class="d-flex mt-2">
            <input
              type="text"
              id="newTask"
              class="form-control me-2"
              placeholder="Add new task"
            />
            <button type="submit" class="btn btn-primary">Add</button>
          </form>
        </div>
      </div>

      <!-- My Journal Section (Centered) -->
      <div class="mt-5 row justify-content-center">
        <div class="col-md-8">
          <h5 class="text-center">My Journal</h5>
          <form id="journalForm" class="mb-3">
            <textarea
              id="journalEntry"
              class="form-control mb-2"
              placeholder="Write your thoughts or reflections here..."
              rows="4"
            ></textarea>
            <button type="submit" class="btn btn-primary w-100">
              Save Entry
            </button>
          </form>

          <ul id="journalList" class="list-group"></ul>
        </div>
      </div>
    </div>

    <script>
      // Load user
      let user = JSON.parse(localStorage.getItem("currentUser"));
      if (!user) window.location.href = "login.html";

      // Profile info
      const nameInput = document.getElementById("name");
      const emailInput = document.getElementById("email");
      const welcomeEl = document.getElementById("welcome");
      const profileMsg = document.getElementById("profileMsg");

      function updateProfileForm() {
        nameInput.value = user.name || "";
        emailInput.value = user.email || "";
        welcomeEl.textContent = `Welcome, ${user.name || "User"}!`;
      }
      updateProfileForm();

      document
        .getElementById("profileForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          user.name = nameInput.value.trim();
          user.email = emailInput.value.trim();
          saveUser();
          updateProfileForm();
          profileMsg.textContent = "Profile updated successfully!";
          setTimeout(() => (profileMsg.textContent = ""), 2000);
        });

      // -------------------
      // MOOD TRACKER LOGIC
      // -------------------
      const questions = [
        "How was your energy level today?",
        "Did you feel anxious or stressed?",
        "Were you able to focus well?",
        "Did you feel supported by others?",
        "Did you sleep well last night?",
        "How satisfied do you feel with your productivity?",
        "Did you do something that made you happy?",
        "Did you spend time outdoors or relax?",
        "Do you feel grateful today?",
        "Did you eat and hydrate well?",
      ];

      const moodForm = document.getElementById("moodForm");
      const moodQuestions = document.getElementById("moodQuestions");
      const moodFeedback = document.getElementById("moodFeedback");
      const moodChartEl = document.getElementById("moodChart");

      // Load questions dynamically
      questions.forEach((q, i) => {
        const div = document.createElement("div");
        div.className = "mb-3";
        div.innerHTML = `
          <label class="form-label">${i + 1}. ${q}</label>
          <select class="form-select" name="q${i + 1}" required>
            <option value="">Select rating</option>
            <option value="1">1 - Very Low</option>
            <option value="2">2 - Low</option>
            <option value="3">3 - Neutral</option>
            <option value="4">4 - Good</option>
            <option value="5">5 - Excellent</option>
          </select>
        `;
        moodQuestions.appendChild(div);
      });

      // Initialize mood history
      user.moodHistory = user.moodHistory || [];

      moodForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const ratings = [...moodForm.querySelectorAll("select")].map((s) =>
          parseInt(s.value)
        );
        const avgMood =
          ratings.reduce((a, b) => a + b, 0) / ratings.length || 0;

        const today = new Date().toLocaleDateString();
        user.moodHistory.push({ date: today, score: avgMood });
        saveUser();

        // Generate motivational feedback
        let feedbackMsg = "";
        if (avgMood >= 4) {
          feedbackMsg =
            "You're doing great today! Keep the positive energy flowing with a short meditation or journaling session.";
        } else if (avgMood >= 3) {
          feedbackMsg =
            "You’re doing okay — maybe take a walk, stretch, or chat with someone you trust to lift your mood.";
        } else {
          feedbackMsg =
            "It seems like you had a tough day. Take deep breaths, journal your thoughts, and remember tomorrow is a fresh start.";
        }

        moodFeedback.textContent = feedbackMsg;
        renderMoodChart();
        moodForm.reset();
      });

      // Render mood chart
      let moodChart;
      function renderMoodChart() {
        const labels = user.moodHistory.map((m) => m.date);
        const data = user.moodHistory.map((m) => m.score);

        if (moodChart) moodChart.destroy();
        moodChart = new Chart(moodChartEl, {
          type: "line",
          data: {
            labels,
            datasets: [
              {
                label: "Mood Score (1–5)",
                data,
                borderColor: "rgba(54, 162, 235, 1)",
                backgroundColor: "rgba(54, 162, 235, 0.2)",
                fill: true,
                tension: 0.3,
              },
            ],
          },
          options: {
            scales: {
              y: {
                min: 1,
                max: 5,
                ticks: { stepSize: 1 },
              },
            },
          },
        });
      }

      renderMoodChart();

      // -------------------
      // TASK MANAGEMENT
      // -------------------
      const tasksDoneEl = document.getElementById("tasksDone");
      const tasksToDoEl = document.getElementById("tasksToDo");
      const addTaskForm = document.getElementById("addTaskForm");
      const newTaskInput = document.getElementById("newTask");

      function renderTasks() {
        tasksDoneEl.innerHTML = "";
        tasksToDoEl.innerHTML = "";

        (user.tasksDone || []).forEach((task, index) => {
          const li = document.createElement("li");
          li.className =
            "list-group-item d-flex justify-content-between align-items-center";
          li.textContent = task;

          const btn = document.createElement("button");
          btn.className = "btn btn-sm btn-danger";
          btn.textContent = "Delete";
          btn.onclick = () => {
            user.tasksDone.splice(index, 1);
            saveUser();
            renderTasks();
          };
          li.appendChild(btn);
          tasksDoneEl.appendChild(li);
        });

        (user.tasksToDo || []).forEach((task, index) => {
          const li = document.createElement("li");
          li.className =
            "list-group-item d-flex justify-content-between align-items-center";
          li.textContent = task;

          const actions = document.createElement("div");

          const doneBtn = document.createElement("button");
          doneBtn.className = "btn btn-sm btn-success me-2";
          doneBtn.textContent = "Done";
          doneBtn.onclick = () => {
            user.tasksDone = user.tasksDone || [];
            user.tasksDone.push(task);
            user.tasksToDo.splice(index, 1);
            saveUser();
            renderTasks();
          };

          const delBtn = document.createElement("button");
          delBtn.className = "btn btn-sm btn-danger";
          delBtn.textContent = "Delete";
          delBtn.onclick = () => {
            user.tasksToDo.splice(index, 1);
            saveUser();
            renderTasks();
          };

          actions.appendChild(doneBtn);
          actions.appendChild(delBtn);
          li.appendChild(actions);
          tasksToDoEl.appendChild(li);
        });
      }

      renderTasks();

      addTaskForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const task = newTaskInput.value.trim();
        if (task) {
          user.tasksToDo = user.tasksToDo || [];
          user.tasksToDo.push(task);
          saveUser();
          renderTasks();
          newTaskInput.value = "";
        }
      });

      // -------------------
      // JOURNAL / NOTES
      // -------------------
      const journalForm = document.getElementById("journalForm");
      const journalEntryInput = document.getElementById("journalEntry");
      const journalListEl = document.getElementById("journalList");

      user.journal = user.journal || [];

      function renderJournal() {
        journalListEl.innerHTML = "";
        // show newest first
        (user.journal || [])
          .slice()
          .reverse()
          .forEach((entry, idx) => {
            const li = document.createElement("li");
            li.className =
              "list-group-item d-flex justify-content-between align-items-start";

            const left = document.createElement("div");
            left.className = "ms-2 me-auto";

            const title = document.createElement("div");
            title.className = "fw-bold";
            title.textContent = new Date(entry.date).toLocaleString();
            left.appendChild(title);

            const p = document.createElement("div");
            p.textContent =
              entry.text.length > 200
                ? entry.text.slice(0, 200) + "…"
                : entry.text;
            left.appendChild(p);

            li.appendChild(left);

            const btns = document.createElement("div");

            const viewBtn = document.createElement("button");
            viewBtn.className = "btn btn-sm btn-outline-primary me-2";
            viewBtn.textContent = "View";
            viewBtn.onclick = () => {
              // simple view using alert for now (lightweight)
              alert(
                `${new Date(entry.date).toLocaleString()}\n\n${entry.text}`
              );
            };

            const delBtn = document.createElement("button");
            delBtn.className = "btn btn-sm btn-danger";
            delBtn.textContent = "Delete";
            delBtn.onclick = () => {
              // since we reversed the list for display, compute real index
              const realIndex = user.journal.length - 1 - idx;
              user.journal.splice(realIndex, 1);
              saveUser();
              renderJournal();
            };

            btns.appendChild(viewBtn);
            btns.appendChild(delBtn);
            li.appendChild(btns);

            journalListEl.appendChild(li);
          });
      }

      journalForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const text = journalEntryInput.value.trim();
        if (!text) return;
        user.journal = user.journal || [];
        user.journal.push({ date: new Date().toISOString(), text });
        saveUser();
        journalEntryInput.value = "";
        renderJournal();
      });

      renderJournal();

      function saveUser() {
        localStorage.setItem("currentUser", JSON.stringify(user));
      }

      function logout() {
        localStorage.removeItem("currentUser");
        window.location.href = "login.html";
      }
    </script>

    <!-- footer -->
    <footer class="bg-dark text-white py-5">
      <div class="container">
        <div class="row g-4">
          <div class="col-lg-4">
            <h5 class="mb-3">
              <img
                src="images/mindwellLogo.png"
                alt="MindWell AI Logo"
                width="32"
                height="32"
                style="vertical-align: middle; margin-right: 8px"
              />
              MindWell AI
            </h5>
            <p class="mb-3">
              Empowering mental wellness through innovative AI technology.
            </p>
            <div class="social-links" aria-label="Social Media Links">
              <a href="#" class="text-white me-3" aria-label="Facebook"
                ><i class="fab fa-facebook"></i
              ></a>
              <a href="#" class="text-white me-3" aria-label="Twitter"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="#" class="text-white me-3" aria-label="Instagram"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="#" class="text-white" aria-label="LinkedIn"
                ><i class="fab fa-linkedin"></i
              ></a>
            </div>
          </div>
          <div class="col-lg-2">
            <h6 class="mb-3">Quick Links</h6>
            <ul class="list-unstyled">
              <li>
                <a href="features.html" class="text-white-50">Features</a>
              </li>
              <li>
                <a href="resources.html" class="text-white-50">Resources</a>
              </li>
              <li><a href="about.html" class="text-white-50">About Us</a></li>
              <li><a href="contact.html" class="text-white-50">Contact</a></li>
            </ul>
          </div>
          <div class="col-lg-3">
            <h6 class="mb-3">Resources</h6>
            <ul class="list-unstyled">
              <li><a href="#" class="text-white-50">Blog</a></li>
              <li><a href="#" class="text-white-50">Mental Health Tips</a></li>
              <li><a href="#" class="text-white-50">FAQ</a></li>
              <li><a href="#" class="text-white-50">Support</a></li>
            </ul>
          </div>
          <div class="col-lg-3">
            <h6 class="mb-3">Newsletter</h6>
            <p class="small">Subscribe for updates and wellness tips</p>
            <form class="mb-3">
              <div class="input-group">
                <input
                  type="email"
                  class="form-control"
                  placeholder="Enter your email"
                />
                <button class="btn btn-primary" type="submit">Subscribe</button>
              </div>
            </form>
          </div>
        </div>
        <hr class="my-4" />
        <div class="row">
          <div class="col-md-6 text-center text-md-start">
            <p class="mb-0">&copy; 2025 MindWell AI. All Rights Reserved.</p>
          </div>
          <div class="col-md-6 text-center text-md-end">
            <a href="privacy.html" class="text-white-50 me-3">Privacy Policy</a>
            <a href="terms.html" class="text-white-50">Terms of Service</a>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="chatbot-new.js" defer></script>
  </body>
</html>
